#!/bin/bash

# AWS Amplify λ°°ν¬ μ¤ν¬λ¦½νΈ

echo "π€ AWS Amplify λ°°ν¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤..."

# 1. μμ΅΄μ„± μ„¤μΉ
echo "π“¦ μμ΅΄μ„±μ„ μ„¤μΉν•©λ‹λ‹¤..."
npm install

# 2. λΉλ“ ν…μ¤νΈ
echo "π”¨ λΉλ“λ¥Ό ν…μ¤νΈν•©λ‹λ‹¤..."
npm run build

# 3. λΉλ“ μ„±κ³µ ν™•μΈ
if [ $? -eq 0 ]; then
    echo "β… λΉλ“κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λμ—μµλ‹λ‹¤!"
    
    # 4. Git μƒνƒ ν™•μΈ
    echo "π“‹ Git μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤..."
    git status
    
    # 5. λ³€κ²½μ‚¬ν•­ μ»¤λ°‹ (μ„ νƒμ‚¬ν•­)
    read -p "λ³€κ²½μ‚¬ν•­μ„ μ»¤λ°‹ν•μ‹κ² μµλ‹κΉ? (y/n): " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        git add .
        git commit -m "Deploy to AWS Amplify"
        git push origin main
        echo "β… λ³€κ²½μ‚¬ν•­μ΄ GitHubμ— ν‘Έμ‹λμ—μµλ‹λ‹¤!"
    fi
    
    echo "π‰ λ°°ν¬ μ¤€λΉ„κ°€ μ™„λ£λμ—μµλ‹λ‹¤!"
    echo "π“ λ‹¤μ λ‹¨κ³„:"
    echo "   1. AWS Amplify μ½μ†”μ— μ ‘μ†ν•μ„Έμ”"
    echo "   2. 'Host web app'μ„ ν΄λ¦­ν•μ„Έμ”"
    echo "   3. GitHub μ €μ¥μ†λ¥Ό μ—°κ²°ν•μ„Έμ”"
    echo "   4. λΉλ“ μ„¤μ •μ„ ν™•μΈν•μ„Έμ”"
    echo "   5. λ°°ν¬λ¥Ό μ‹μ‘ν•μ„Έμ”"
    
else
    echo "β λΉλ“μ— μ‹¤ν¨ν–μµλ‹λ‹¤. μ¤λ¥λ¥Ό ν™•μΈν•΄μ£Όμ„Έμ”."
    exit 1
fi
